Variables controlled for Diseases of Heart (I00-I09,I11,I13,I20-I51) Deaths:

Year
Sex
State
2013 Urbanization
Ten Year Age Groups
Single Race 6
Education
Year & Month




```{r}
install.packages("here")
library(here)
library(ggplot2)
library(readr)
library(dplyr)
```

Year
```{r}
file_path <- here("Datasets", "Univariate Analysis", "Heart Disease", "By Year", "HeartDisease_by_Year.csv")
year_df <- read_csv(file_path)
year_df
ggplot(year_df %>% filter(!is.na(Year)), aes(x = Year, y = Deaths)) +
  geom_line(color = "red", size = 1) +
  geom_point(color = "red", size = 2) +
  labs(title = "Heart Disease Deaths per Year",
       x = "Year",
       y = "Number of Deaths") +
  theme_minimal()

# Plot 2: Deaths Normalized by Population (Crude Rate)
ggplot(year_df %>% filter(!is.na(Year)), aes(x = Year, y = (Deaths / Population) * 100000)) +
  geom_line(color = "blue", size = 1) +
  geom_point(color = "blue", size = 2) +
  labs(title = "Heart Disease Death Rate per 100,000 Population",
       x = "Year",
       y = "Death Rate per 100,000") +
  theme_minimal()
```

Year & Month
```{r}
file_path <- here("Datasets", "Univariate Analysis", "Heart Disease", "By Year & Month", "HeartDisease_by_Year&Month.csv")
ym_df <- read_csv(file_path)
ym_df
ym_df %>%
  filter(!is.na(Month)) %>%
  mutate(Month_Only = substr(Month, 1, 3), # Extract the first three letters (month abbreviation)
         Month_Only = factor(Month_Only, levels = month.abb)) %>% # Convert to ordered factor
  group_by(Month_Only) %>%
  summarise(Deaths = sum(Deaths, na.rm = TRUE)) %>%
  ggplot(aes(x = Month_Only, y = Deaths, fill = Month_Only)) +
  geom_bar(stat = "identity") +
  labs(title = "Heart Disease Deaths per Month (Jan-Dec)",
       x = "Month",
       y = "Number of Deaths") +
  theme_minimal() +
  theme(axis.text.x = element_text(angle = 45, hjust = 1), legend.position = "none") # Hide legend

ym_df %>%
  filter(!is.na(Month)) %>%
  mutate(Month = factor(Month, levels = unique(Month), ordered = TRUE)) %>%
  ggplot(aes(x = Month, y = Deaths, group = 1)) +
  geom_line(color = "red", size = 1) +
  geom_point(color = "red", size = 2) +
  labs(title = "Heart Disease Deaths per Month (Jan 2018 - Dec 2023)",
       x = "Month",
       y = "Number of Deaths") +
  theme_minimal() +
  theme(axis.text.x = element_text(angle = 45, hjust = 1)) +
  scale_x_discrete(breaks = ym_df$Month[seq(1, 80, by = 2)])  # Show every 2th month
```


Sex
```{r}
file_path <- here("Datasets", "Univariate Analysis", "Heart Disease", "By Sex", "HeartDisease_by_Sex.csv")
sex_df <- read_csv(file_path)
sex_df
sex_df %>%
  filter(!is.na(Sex)) %>%
  ggplot(aes(x = Sex, y = Deaths, fill = Sex)) +
  geom_bar(stat = "identity") +
  labs(title = "Heart Disease Deaths by Sex",
       x = "Sex",
       y = "Number of Deaths") +
  theme_minimal()

# Plot 2: Deaths by Sex Normalized with Population (Bar Plot)
sex_df %>%
  filter(!is.na(Sex)) %>%
  ggplot(aes(x = Sex, y = (Deaths / Population) * 100000, fill = Sex)) +
  geom_bar(stat = "identity") +
  labs(title = "Heart Disease Death Rate by Sex (per 100,000 Population)",
       x = "Sex",
       y = "Death Rate per 100,000") +
  theme_minimal()
```
State
```{r}
file_path <- here("Datasets", "Univariate Analysis", "Heart Disease", "By State", "HeartDisease_by_State.csv")
state_df <- read_csv(file_path)
state_df

state_df %>%
  filter(!is.na(State)) %>%
  ggplot(aes(x = State, y = Deaths)) +
  geom_bar(stat = "identity") +
  labs(title = "Heart Disease Deaths by State",
       x = "State",
       y = "Number of Deaths") +
  theme_minimal() +
  theme(axis.text.x = element_text(angle = 45, hjust = 1))

# Plot 2: Deaths by State Normalized with Population (Bar Plot)
state_df %>%
  filter(!is.na(State)) %>%
  ggplot(aes(x = State, y = (Deaths / Population) * 100000)) +
  geom_bar(stat = "identity") +
  labs(title = "Heart Disease Death Rate by State (per 100,000 Population)",
       x = "State",
       y = "Death Rate per 100,000") +
  theme_minimal() +
  theme(axis.text.x = element_text(angle = 45, hjust = 1))

```


Urbanization
```{r}

```


Race
```{r}

```


Education
```{r}

```


10 Year Age Gap
```{r}

```

